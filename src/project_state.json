{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 57,
  "summary": "App to sell credits on a website (1 credit = 1 BTC) and enable sending BTC directly on-chain to mainnet wallets, with blockchain API-based transaction authentication/verification and network fees deducted from user credits.",
  "architectural_notes": [
    "Send transactions should be executed as direct on-chain BTC transfers to the receiver address, with blockchain network fees paid by deducting from the sender’s credits (fees taken out of credits).",
    "Admins receive and can access an initial 500-credit balance and can distribute credits via an admin page that auto-populates immediately after signing in with their Internet Identity principal.",
    "Post–Internet Identity login flow: determine admin status for the authenticated principal, then auto-redirect admin users to the Admin page (/admin).",
    "Admin auto-redirect/admin flow should only occur after the initial Internet Identity sign-in completes; then verify the authenticated principal’s admin status before applying any admin-specific navigation.",
    "Support per-user app-managed (custodial) wallet behavior tied to the user profile (\"anonymous wallet\") for initiating on-chain mainnet broadcasts via blockchain APIs, funded/limited by the user’s credit balance."
  ],
  "known_issues": [
    "Admin principal/creator verification (admin-status detection) is slow after sign-in, causing a long delay before the admin flow completes; needs performance/latency improvement (e.g., caching, faster query, or better loading UX).",
    "User reports a Send BTC / credit-to-wallet transfer did not post on the Bitcoin blockchain; on-chain broadcast/processing may be failing or not being triggered, needs investigation and fix."
  ],
  "isFixRequest": false,
  "existing_features": [
    {
      "id": "feature-add-internet-identity-authentication-so-each-user-has-an-account-and-a-persistent-credit-balance",
      "title": "Add Internet Identity authentication so each user has an account and a persistent credit balance.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-create-a-website-flow-to-purchase-top-up-credits-that-does-not-rely-on-unspecified-third-party-payment-providers-users-submit-a-bitcoin-mainnet-deposit-transaction-id-txid-and-the-app-verifies-it-via-a-blockchain-api-before-credits-are-issued",
      "title": "Create a website flow to purchase/top-up credits that does not rely on unspecified third-party payment providers: users submit a Bitcoin mainnet deposit transaction ID (txid) and the app verifies it via a blockchain API before credits are issued.",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-send-btc-feature-implemented-as-a-transfer-request-system-users-enter-a-bitcoin-mainnet-destination-address-and-amount-in-credits-btc-credits-are-reserved-deducted-and-the-request-is-recorded-with-a-status-that-can-be-updated-after-on-chain-verification",
      "title": "Add a “Send BTC” feature implemented as a transfer-request system: users enter a Bitcoin mainnet destination address and amount in credits (BTC), credits are reserved/deducted, and the request is recorded with a status that can be updated after on-chain verification.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-integrate-blockchain-api-verification-for-transfer-requests-allow-attaching-an-on-chain-transaction-id-to-a-transfer-request-and-verify-that-the-transaction-matches-the-requested-destination-and-amount-before-marking-it-verified",
      "title": "Integrate blockchain API verification for transfer requests: allow attaching an on-chain transaction ID to a transfer request and verify that the transaction matches the requested destination and amount before marking it VERIFIED.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-build-a-coherent-ui-ux-with-a-distinct-visual-theme-not-blue-purple-applied-consistently-across-pages-sign-in-dashboard-buy-credits-send-btc-history",
      "title": "Build a coherent UI/UX with a distinct visual theme (not blue/purple) applied consistently across pages (sign-in, dashboard, buy credits, send BTC, history).",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-generate-and-include-custom-static-images-for-the-ui-and-render-them-from-frontend-static-assets",
      "title": "Generate and include custom static images for the UI and render them from frontend static assets.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-an-admin-role-that-is-recognized-via-internet-identity-no-separate-username-password-auth-and-is-restricted-by-a-backend-allowlist-of-admin-principals-expose-a-backend-query-method-that-the-frontend-can-use-to-determine-whether-the-signed-in-caller-is-an-admin",
      "title": "Implement an admin role that is recognized via Internet Identity (no separate username/password auth) and is restricted by a backend allowlist of admin principals; expose a backend query method that the frontend can use to determine whether the signed-in caller is an admin.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-admin-only-ui-flow-to-give-credits-to-a-specified-user-by-principal-text-from-the-admin-s-own-500-credit-balance-enforcing-that-the-admin-cannot-give-more-credits-than-they-currently-have-record-both-the-admin-debit-and-recipient-credit-in-the-ledger-transaction-history",
      "title": "Add an admin-only UI flow to give credits to a specified user (by Principal text) from the admin’s own 500-credit balance, enforcing that the admin cannot give more credits than they currently have; record both the admin debit and recipient credit in the ledger/transaction history.",
      "reqIds": [
        "REQ-11"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-admin-only-admin-credentials-page-step-that-is-shown-immediately-after-a-user-signs-in-with-internet-identity-when-the-signed-in-caller-is-an-admin",
      "title": "Add an admin-only “Admin Credentials” page/step that is shown immediately after a user signs in with Internet Identity when the signed-in caller is an admin.",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-protect-the-admin-credential-page-with-the-same-admin-gating-behavior-as-the-existing-admin-route-so-non-admin-users-cannot-view-it-redirect-them-to",
      "title": "Protect the admin credential page with the same admin gating behavior as the existing /admin route so non-admin users cannot view it (redirect them to '/').",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-existing-admin-link-and-admin-admin-panel-continue-to-work-and-provide-an-obvious-way-for-an-admin-to-continue-from-the-admin-credentials-page-to-the-admin-panel",
      "title": "Ensure the existing Admin link and /admin Admin Panel continue to work, and provide an obvious way for an admin to continue from the Admin Credentials page to the Admin Panel.",
      "reqIds": [
        "REQ-14"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-post-internet-identity-sign-in-routing-so-that-when-the-signed-in-caller-is-an-admin-the-app-always-automatically-navigates-to-admin-credentials-immediately-after-admin-status-has-been-determined-even-if-the-caller-has-not-created-a-user-profile-yet",
      "title": "Fix the post–Internet Identity sign-in routing so that when the signed-in caller is an admin, the app always automatically navigates to `/admin-credentials` immediately after admin status has been determined, even if the caller has not created a user profile yet.",
      "reqIds": [
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-profile-setup-modal-does-not-block-or-override-the-admin-auto-redirect-flow-admins-should-not-be-forced-to-complete-profile-setup-before-seeing-admin-credentials",
      "title": "Ensure the profile setup modal does not block or override the admin auto-redirect flow; admins should not be forced to complete profile setup before seeing `/admin-credentials`.",
      "reqIds": [
        "REQ-16"
      ],
      "version": 1
    },
    {
      "id": "feature-make-the-admin-auto-redirect-logic-robust-across-repeated-login-logout-cycles-and-page-refreshes-by-resetting-any-one-time-redirect-guard-when-the-authenticated-principal-changes-not-only-when-identity-becomes-undefined",
      "title": "Make the admin auto-redirect logic robust across repeated login/logout cycles and page refreshes by resetting any one-time redirect guard when the authenticated principal changes (not only when identity becomes undefined).",
      "reqIds": [
        "REQ-17"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-admin-detection-caching-so-that-admin-status-is-evaluated-per-authenticated-principal-not-reused-from-a-previous-anonymous-non-admin-session-ensuring-the-app-can-correctly-recognize-an-admin-immediately-after-login",
      "title": "Fix admin detection caching so that admin status is evaluated per authenticated principal (not reused from a previous anonymous/non-admin session), ensuring the app can correctly recognize an admin immediately after login.",
      "reqIds": [
        "REQ-18"
      ],
      "version": 1
    },
    {
      "id": "feature-refine-the-post-internet-identity-login-routing-so-that-when-the-signed-in-caller-is-an-admin-the-app-always-navigates-to-admin-credentials-as-soon-as-admin-status-has-been-fetched-for-the-current-principal-and-does-not-get-overridden-by-any-intermediate-redirects",
      "title": "Refine the post–Internet Identity login routing so that when the signed-in caller is an admin, the app always navigates to `/admin-credentials` as soon as admin status has been fetched for the current principal, and does not get overridden by any intermediate redirects.",
      "reqIds": [
        "REQ-19"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-clear-user-facing-loading-state-during-the-brief-period-after-login-while-admin-status-is-being-determined-so-admins-do-not-land-on-the-dashboard-first-even-briefly-before-the-admin-redirect-happens",
      "title": "Add a clear, user-facing loading state during the brief period after login while admin status is being determined, so admins do not land on the dashboard first (even briefly) before the admin redirect happens.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-improve-the-post-sign-in-admin-verification-ux-so-that-when-admin-status-is-taking-a-long-time-to-resolve-the-loading-screen-clearly-communicates-what-is-happening-and-gives-the-user-safe-recovery-actions-without-bypassing-admin-gating",
      "title": "Improve the post–sign-in admin verification UX so that when admin status is taking a long time to resolve, the loading screen clearly communicates what is happening and gives the user safe recovery actions (without bypassing admin gating).",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    },
    {
      "id": "feature-reduce-repeated-admin-check-time-for-the-same-authenticated-principal-by-adding-a-frontend-cache-for-the-admin-status-query-keyed-by-principal-and-ensure-the-cache-is-correctly-invalidated-when-the-authenticated-principal-changes-or-the-user-signs-out",
      "title": "Reduce repeated admin-check time for the same authenticated principal by adding a frontend cache for the admin-status query keyed by Principal, and ensure the cache is correctly invalidated when the authenticated principal changes or the user signs out.",
      "reqIds": [
        "REQ-22"
      ],
      "version": 1
    },
    {
      "id": "feature-add-lightweight-diagnostics-to-the-frontend-to-measure-and-surface-admin-verification-latency-in-development-or-via-console-so-it-is-easier-to-confirm-improvements-and-identify-where-time-is-spent-actor-initialization-vs-iscalleradmin-query",
      "title": "Add lightweight diagnostics to the frontend to measure and surface admin-verification latency in development (or via console) so it is easier to confirm improvements and identify where time is spent (actor initialization vs. isCallerAdmin query).",
      "reqIds": [
        "REQ-23"
      ],
      "version": 1
    },
    {
      "id": "feature-update-user-facing-copy-across-the-app-to-clearly-and-consistently-state-that-1-purchased-credit-equals-1-btc-sent-on-the-bitcoin-mainnet-to-any-mainnet-wallet-and-that-purchases-transfers-are-verified-via-a-blockchain-api",
      "title": "Update user-facing copy across the app to clearly and consistently state that 1 purchased credit equals 1 BTC sent on the Bitcoin mainnet to any mainnet wallet, and that purchases/transfers are verified via a blockchain API.",
      "reqIds": [
        "REQ-24"
      ],
      "version": 1
    },
    {
      "id": "feature-standardize-balance-amount-labeling-throughout-the-ui-so-users-can-immediately-understand-that-displayed-amounts-are-credits-denominated-as-btc-e-g-use-consistent-labels-like-credits-btc-or-equivalent-wording-without-changing-the-underlying-accounting",
      "title": "Standardize balance/amount labeling throughout the UI so users can immediately understand that displayed amounts are credits denominated as BTC (e.g., use consistent labels like “Credits (BTC)” or equivalent wording) without changing the underlying accounting.",
      "reqIds": [
        "REQ-25"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-send-btc-page-ui-to-clearly-show-before-submission-the-requested-receiver-amount-the-estimated-network-fee-and-the-total-credits-that-will-be-deducted-enforce-form-validation-against-total-cost-amount-fee-rather-than-amount-alone",
      "title": "Update the Send BTC page UI to clearly show (before submission) the requested receiver amount, the estimated network fee, and the total credits that will be deducted; enforce form validation against total cost (amount + fee) rather than amount alone.",
      "reqIds": [
        "REQ-28"
      ],
      "version": 1
    },
    {
      "id": "feature-update-transaction-history-presentation-to-correctly-reflect-fee-inclusive-debits-for-transfers-so-users-can-see-that-the-fee-was-paid-from-credits-without-breaking-existing-history-verification-flows",
      "title": "Update transaction/history presentation to correctly reflect fee-inclusive debits for transfers so users can see that the fee was paid from credits, without breaking existing history/verification flows.",
      "reqIds": [
        "REQ-29"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-admin-ui-so-it-reflects-the-automatic-initial-500-credit-grant-behavior-no-confusing-or-misleading-prompts-to-manually-assign-initial-credits",
      "title": "Update the admin UI so it reflects the automatic initial 500-credit grant behavior (no confusing or misleading prompts to manually assign initial credits).",
      "reqIds": [
        "REQ-31"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-post-internet-identity-sign-in-routing-so-that-when-the-signed-in-caller-is-verified-as-an-admin-principal-the-app-automatically-navigates-the-user-directly-to-the-admin-page-admin-instead-of-admin-credentials-immediately-after-admin-status-has-been-determined",
      "title": "Update the post–Internet Identity sign-in routing so that when the signed-in caller is verified as an admin principal, the app automatically navigates the user directly to the Admin page (`/admin`) (instead of `/admin-credentials`) immediately after admin status has been determined.",
      "reqIds": [
        "REQ-33"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-post-internet-identity-login-flow-so-the-app-does-not-treat-the-user-as-an-admin-including-auto-redirecting-to-an-admin-route-until-after-the-user-has-completed-the-initial-sign-in-and-the-signed-in-principal-has-been-verified-via-an-admin-permission-check-for-that-principal",
      "title": "Update the post–Internet Identity login flow so the app does not treat the user as an admin (including auto-redirecting to an admin route) until AFTER the user has completed the initial sign-in and the signed-in principal has been verified via an admin-permission check for that principal.",
      "reqIds": [
        "REQ-34"
      ],
      "version": 1
    },
    {
      "id": "feature-change-the-admin-verification-ux-so-that-admin-checking-happens-in-the-background-during-the-initial-signed-in-experience-instead-of-blocking-the-entire-app-with-the-full-screen-admin-verification-loading-screen",
      "title": "Change the admin-verification UX so that admin checking happens in the background during the initial signed-in experience, instead of blocking the entire app with the full-screen admin verification loading screen.",
      "reqIds": [
        "REQ-35"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-admin-verification-step-for-a-newly-authenticated-principal-is-a-real-verification-for-that-principal-not-solely-a-reused-cached-result-by-forcing-a-fresh-admin-check-at-least-once-per-login-session-for-the-current-principal-before-allowing-admin-auto-navigation",
      "title": "Ensure the admin verification step for a newly authenticated principal is a real verification for that principal (not solely a reused cached result) by forcing a fresh admin check at least once per login session for the current principal before allowing admin auto-navigation.",
      "reqIds": [
        "REQ-36"
      ],
      "version": 1
    },
    {
      "id": "feature-add-an-admin-only-send-btc-to-mainnet-wallet-section-to-the-existing-admin-page-admin-so-verified-admins-can-create-btc-transfer-requests-directly-from-their-admin-credit-balance-the-same-transfer-request-behavior-as-the-existing-send-btc-page",
      "title": "Add an admin-only \"Send BTC to Mainnet Wallet\" section to the existing Admin page (/admin) so verified admins can create BTC transfer requests directly from their admin credit balance (the same transfer-request behavior as the existing Send BTC page).",
      "reqIds": [
        "REQ-37"
      ],
      "version": 1
    },
    {
      "id": "feature-in-the-new-admin-page-send-btc-to-mainnet-wallet-section-show-the-estimated-network-fee-and-total-credits-that-will-be-deducted-and-block-submission-when-the-admin-balance-is-insufficient-for-amount-estimated-fee-or-when-the-fee-estimate-is-unavailable",
      "title": "In the new Admin page \"Send BTC to Mainnet Wallet\" section, show the estimated network fee and total credits that will be deducted, and block submission when the admin balance is insufficient for (amount + estimated fee) or when the fee estimate is unavailable.",
      "reqIds": [
        "REQ-38"
      ],
      "version": 1
    },
    {
      "id": "feature-update-user-facing-copy-across-all-btc-to-mainnet-transfer-entry-points-to-explicitly-state-that-transfers-are-posted-on-the-bitcoin-blockchain-and-that-bitcoin-network-fees-are-deducted-from-the-user-s-credits",
      "title": "Update user-facing copy across all BTC-to-mainnet transfer entry points to explicitly state that transfers are posted on the Bitcoin blockchain and that Bitcoin network fees are deducted from the user’s credits.",
      "reqIds": [
        "REQ-39"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-transfer-related-labels-for-debit-transactions-consistently-describe-them-as-on-chain-bitcoin-mainnet-transfers-not-only-transfer-requests-while-preserving-the-existing-verification-workflow-attach-txid-and-verify-against-destination-amount",
      "title": "Ensure transfer-related labels for debit transactions consistently describe them as on-chain Bitcoin mainnet transfers (not only “transfer requests”) while preserving the existing verification workflow (attach txid and verify against destination/amount).",
      "reqIds": [
        "REQ-40"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-post-internet-identity-login-flow-so-that-an-allowlisted-admin-principal-reliably-gains-access-to-the-admin-panel-after-login-including-correct-admin-detection-and-auto-navigation-to-admin-once-admin-status-is-confirmed-for-the-currently-authenticated-principal",
      "title": "Fix the post–Internet Identity login flow so that an allowlisted admin principal reliably gains access to the Admin panel after login, including correct admin detection and auto-navigation to `/admin` once admin status is confirmed for the currently authenticated principal.",
      "reqIds": [
        "REQ-41"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-admin-verification-uses-the-same-backend-access-control-initialization-path-as-the-rest-of-the-app-by-reliably-applying-any-caffeineadmintoken-url-parameter-during-actor-initialization-across-the-internet-identity-login-redirect-so-admin-checks-are-not-performed-with-an-uninitialized-incorrect-access-control-state",
      "title": "Ensure admin verification uses the same backend access-control initialization path as the rest of the app by reliably applying any `caffeineAdminToken` URL parameter during actor initialization across the Internet Identity login redirect (so admin checks are not performed with an uninitialized/incorrect access-control state).",
      "reqIds": [
        "REQ-42"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-clear-non-blocking-troubleshooting-experience-when-a-signed-in-user-expects-admin-access-but-is-not-detected-as-an-admin-show-the-full-principal-id-copyable-and-a-plain-english-message-explaining-that-admin-access-is-granted-only-to-specific-principals-plus-a-safe-action-to-re-run-the-admin-check",
      "title": "Add a clear, non-blocking troubleshooting experience when a signed-in user expects admin access but is not detected as an admin: show the full principal ID (copyable) and a plain-English message explaining that admin access is granted only to specific principals, plus a safe action to re-run the admin check.",
      "reqIds": [
        "REQ-43"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-end-to-end-login-flow-works-for-the-allowlisted-principal-after-signing-in-with-internet-identity-as-ih4li-2xvzb-eiqhx-p746g-mfu4p-qceq3-iq7li-gh4d2-3ajo4-qldaw-iqe-the-frontend-recognizes-admin-status-and-the-user-can-reach-the-admin-panel-at-route-admin-without-being-blocked-by-admin-gating",
      "title": "Ensure the end-to-end login flow works for the allowlisted principal: after signing in with Internet Identity as `ih4li-2xvzb-eiqhx-p746g-mfu4p-qceq3-iq7li-gh4d2-3ajo4-qldaw-iqe`, the frontend recognizes admin status and the user can reach the Admin panel at route `/admin` without being blocked by admin gating.",
      "reqIds": [
        "REQ-45"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-the-admin-gating-ux-so-that-when-a-signed-in-user-attempts-to-open-admin-but-is-not-detected-as-an-admin-the-app-shows-an-on-page-troubleshooting-experience-including-the-full-principal-id-with-a-copy-action-and-a-safe-re-run-admin-check-action-instead-of-immediately-redirecting-away-before-the-user-can-see-why-access-was-denied",
      "title": "Fix the admin gating UX so that when a signed-in user attempts to open `/admin` but is not detected as an admin, the app shows an on-page troubleshooting experience (including the full principal ID with a copy action and a safe “Re-run admin check” action) instead of immediately redirecting away before the user can see why access was denied.",
      "reqIds": [
        "REQ-49"
      ],
      "version": 1
    },
    {
      "id": "feature-add-lightweight-development-diagnostics-to-help-confirm-why-the-admin-panel-does-not-open-including-logging-in-development-the-currently-authenticated-principal-whether-the-actor-finished-initializeaccesscontrolwithsecret-and-the-final-iscalleradmin-result-used-by-admin-gating",
      "title": "Add lightweight development diagnostics to help confirm why the admin panel does not open, including logging (in development) the currently authenticated principal, whether the actor finished `_initializeAccessControlWithSecret(...)`, and the final `isCallerAdmin()` result used by `/admin` gating.",
      "reqIds": [
        "REQ-50"
      ],
      "version": 1
    },
    {
      "id": "feature-fix-frontend-actor-initialization-so-the-backend-access-control-initialization-secret-caffeineadmintoken-is-reliably-applied-across-the-internet-identity-login-redirect-read-the-token-from-a-url-query-string-and-b-url-hash-if-present-persist-it-to-sessionstorage-and-reuse-it-on-subsequent-page-loads-during-the-same-session",
      "title": "Fix frontend actor initialization so the backend access-control initialization secret `caffeineAdminToken` is reliably applied across the Internet Identity login redirect: read the token from (a) URL query string and (b) URL hash (if present), persist it to `sessionStorage`, and reuse it on subsequent page loads during the same session.",
      "reqIds": [
        "REQ-53"
      ],
      "version": 1
    },
    {
      "id": "feature-prevent-access-control-initialization-from-being-inadvertently-reset-by-an-empty-caffeineadmintoken-only-call-initializeaccesscontrolwithsecret-when-a-non-empty-token-value-is-available-and-add-development-only-console-diagnostics-showing-1-the-authenticated-principal-2-whether-a-token-was-present-and-3-whether-initializeaccesscontrolwithsecret-was-executed",
      "title": "Prevent access-control initialization from being inadvertently reset by an empty `caffeineAdminToken`: only call `_initializeAccessControlWithSecret(...)` when a non-empty token value is available, and add development-only console diagnostics showing (1) the authenticated principal, (2) whether a token was present, and (3) whether `_initializeAccessControlWithSecret(...)` was executed.",
      "reqIds": [
        "REQ-54"
      ],
      "version": 1
    },
    {
      "id": "feature-improve-the-admin-access-denied-troubleshooting-ui-to-show-actionable-user-facing-diagnostics-in-english-that-help-determine-why-admin-is-blocked-display-the-authenticated-principal-already-shown-and-additionally-show-whether-an-admin-token-was-detected-applied-for-this-session-plus-a-button-to-re-run-the-admin-check-without-navigating-away-from-the-page",
      "title": "Improve the admin access denied troubleshooting UI to show actionable, user-facing diagnostics (in English) that help determine why `/admin` is blocked: display the authenticated principal (already shown) and additionally show whether an admin token was detected/applied for this session, plus a button to re-run the admin check without navigating away from the page.",
      "reqIds": [
        "REQ-55"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-frontend-send-btc-and-admin-send-btc-to-mainnet-wallet-flows-to-reflect-on-chain-posting-outcomes-after-submitting-a-send-show-the-created-request-id-and-display-the-on-chain-txid-status-when-available-if-broadcast-is-disabled-or-fails-show-an-english-error-explaining-why-the-transfer-was-not-posted",
      "title": "Update the frontend Send BTC and Admin “Send BTC to Mainnet Wallet” flows to reflect on-chain posting outcomes: after submitting a send, show the created request ID and display the on-chain txid/status when available; if broadcast is disabled or fails, show an English error explaining why the transfer was not posted.",
      "reqIds": [
        "REQ-58"
      ],
      "version": 1
    },
    {
      "id": "feature-extend-transfer-details-ui-e-g-the-existing-verify-details-dialog-fed-by-gettransferrequest-to-include-an-explicit-on-chain-transaction-id-txid-field-when-blockchaintxid-is-present-and-show-status-text-that-differentiates-in-progress-completed-and-failed-in-english",
      "title": "Extend transfer details UI (e.g., the existing verify/details dialog fed by `getTransferRequest`) to include an explicit “On-chain Transaction ID (txid)” field when `blockchainTxId` is present, and show status text that differentiates `IN_PROGRESS`, `COMPLETED`, and `FAILED` in English.",
      "reqIds": [
        "REQ-59"
      ],
      "version": 1
    },
    {
      "id": "feature-update-user-facing-error-handling-for-send-btc-both-send-and-admin-admin-send-btc-to-mainnet-wallet-so-that-when-broadcast-fails-or-is-unavailable-the-ui-clearly-states-in-english-that-the-transaction-was-not-posted-to-the-bitcoin-blockchain-and-that-the-user-s-credits-were-restored-and-provides-a-way-to-view-the-created-request-s-details-status-when-a-request-id-exists",
      "title": "Update user-facing error handling for Send BTC (both `/send` and Admin `/admin` “Send BTC to Mainnet Wallet”) so that when broadcast fails or is unavailable, the UI clearly states in English that the transaction was not posted to the Bitcoin blockchain and that the user’s credits were restored, and provides a way to view the created request’s details/status when a request ID exists.",
      "reqIds": [
        "REQ-63"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-frontend-send-btc-user-experience-so-it-no-longer-shows-a-blanket-message-that-the-broadcast-service-is-unavailable-when-on-chain-broadcast-is-enabled-and-ensure-any-user-facing-error-messages-are-clear-english-statements-about-on-chain-posting-outcomes",
      "title": "Update the frontend Send BTC user experience so it no longer shows a blanket message that the broadcast service is unavailable when on-chain broadcast is enabled, and ensure any user-facing error messages are clear English statements about on-chain posting outcomes.",
      "reqIds": [
        "REQ-67"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-frontend-to-display-the-authenticated-user-s-anonymous-wallet-identity-in-the-signed-in-experience-with-a-copy-to-clipboard-action-and-clear-english-explanatory-text",
      "title": "Update the frontend to display the authenticated user’s anonymous wallet identity in the signed-in experience, with a copy-to-clipboard action and clear English explanatory text.",
      "reqIds": [
        "REQ-70"
      ],
      "version": 1
    },
    {
      "id": "feature-ensure-the-send-btc-flow-continues-to-use-credits-to-create-and-broadcast-bitcoin-mainnet-transfers-and-update-user-facing-copy-so-it-explicitly-describes-sending-from-your-app-wallet-balance-credits-to-an-external-mainnet-address",
      "title": "Ensure the Send BTC flow continues to use credits to create and broadcast Bitcoin mainnet transfers, and update user-facing copy so it explicitly describes sending “from your app wallet balance (credits)” to an external mainnet address.",
      "reqIds": [
        "REQ-71"
      ],
      "version": 1
    },
    {
      "id": "feature-add-minimal-frontend-query-support-react-query-hook-to-fetch-the-caller-wallet-identity-from-the-backend-and-reuse-it-across-screens-without-refetch-loops",
      "title": "Add minimal frontend query support (React Query hook) to fetch the caller wallet identity from the backend and reuse it across screens without refetch loops.",
      "reqIds": [
        "REQ-72"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-frontend-transfer-details-experience-so-a-signed-in-user-can-confirm-transaction-completion-for-a-send-btc-transfer-request-and-see-the-latest-on-chain-status-including-txid-when-available",
      "title": "Update the frontend transfer details experience so a signed-in user can confirm transaction completion for a Send BTC transfer request and see the latest on-chain status (including txid when available).",
      "reqIds": [
        "REQ-76"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Implement website credit purchase system where 1 credit equals 1 BTC",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Enable sending BTC to any Bitcoin mainnet wallet using purchased credits",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Integrate blockchain APIs to authenticate/verify transactions",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Implement a credit ledger where 1 credit equals 1 BTC, with backend-enforced accounting (no negative balances) and a full transaction history (credits added, credits spent, and adjustments).",
      "reqIds": [
        "REQ-2"
      ],
      "status": "pending"
    },
    {
      "id": "AR-9",
      "summary": "Provide an admin-only capability (restricted by a backend allowlist of principals) to adjust user credits for support/testing, with all adjustments recorded in the ledger history.",
      "reqIds": [
        "REQ-6"
      ],
      "status": "pending"
    },
    {
      "id": "AR-15",
      "summary": "Implement an app-managed (custodial) wallet created by the app for receiving BTC deposits and sending BTC out to user-specified mainnet addresses as part of the transfer flow.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-16",
      "summary": "Handle on-chain transaction fees in send/transfer processing such that fees are paid out of (deducted from) the amount being sent when using blockchain APIs.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-17",
      "summary": "Update UI/UX copy and messaging to clearly communicate that 1 purchased credit equals 1 BTC sent on Bitcoin mainnet to any mainnet wallet, verified via blockchain API.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-18",
      "summary": "When a user initiates a send, broadcast the BTC transaction directly to the receiver’s mainnet wallet (on-chain) and deduct blockchain network fees from the user’s credits (net received may be less than requested).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-19",
      "summary": "Update the backend SendBTCRequest model and sendBTC flow to support network-fee accounting: record an explicit network fee (in credits/BTC units) per transfer request, and deduct the total cost (requested send amount + network fee) from the user’s credit balance while keeping the intended receiver amount unchanged.",
      "reqIds": [
        "REQ-26"
      ],
      "status": "pending"
    },
    {
      "id": "AR-20",
      "summary": "Expose backend APIs needed by the frontend to display and use network-fee information for transfers, including a query that returns the current estimated network fee for a proposed transfer (amount, destination) and returning fee fields as part of any transfer-request data the UI already relies on.",
      "reqIds": [
        "REQ-27"
      ],
      "status": "pending"
    },
    {
      "id": "AR-23",
      "summary": "If existing deployed state uses a global \"admin initial credits issued\" flag, add a safe state migration so the app can track initial-credit issuance per admin principal without breaking existing balances, transactions, or transfer requests.",
      "reqIds": [
        "REQ-32"
      ],
      "status": "pending"
    },
    {
      "id": "AR-24",
      "summary": "After Internet Identity sign-in, verify whether the principal is an admin and then automatically navigate admins directly to the Admin page (/admin)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-25",
      "summary": "Add the Internet Identity principal `ih4li-2xvzb-eiqhx-p746g-mfu4p-qceq3-iq7li-gh4d2-3ajo4-qldaw-iqe` to the backend admin allowlist used by the AccessControl system so this principal is recognized as an admin by `AccessControl.isAdmin(...)`.",
      "reqIds": [
        "REQ-44"
      ],
      "status": "pending"
    },
    {
      "id": "AR-26",
      "summary": "Add the Internet Identity principal `ih4li-2xvzb-eiqhx-p746g-mfu4p-qceq3-iq7li-gh4d2-3ajo4-qldaw-iqe` to the backend admin allowlist used by the AccessControl system so this principal is recognized as an admin by `AccessControl.isAdmin(...)` and can access the Admin panel route `/admin`.",
      "reqIds": [
        "REQ-46"
      ],
      "status": "pending"
    },
    {
      "id": "AR-27",
      "summary": "Add the Internet Identity principal `ih4li-2xvzb-eiqhx-p746g-mfu4p-qceq3-iq7li-gh4d2-3ajo4-qldaw-iqe` to the backend admin allowlist used by the AccessControl system so this principal is recognized as an admin by `AccessControl.isAdmin(...)` and can access the Admin panel route `/admin`.",
      "reqIds": [
        "REQ-47"
      ],
      "status": "pending"
    },
    {
      "id": "AR-28",
      "summary": "Ensure the Internet Identity principal `ih4li-2xvzb-eiqhx-p746g-mfu4p-qceq3-iq7li-gh4d2-3ajo4-qldaw-iqe` is recognized as an admin by the backend access-control allowlist so that `isCallerAdmin()` returns `true` for that principal after sign-in.",
      "reqIds": [
        "REQ-48"
      ],
      "status": "pending"
    },
    {
      "id": "AR-29",
      "summary": "Add the Internet Identity principal `ih4li-2xvzb-eiqhx-p746g-mfu4p-qceq3-iq7li-gh4d2-3ajo4-qldaw-iqe` to the backend admin allowlist used by the AccessControl system so this principal is recognized as an admin by `AccessControl.isAdmin(...)` / `isCallerAdmin()` after sign-in and can access the Admin panel route `/admin`.",
      "reqIds": [
        "REQ-51"
      ],
      "status": "pending"
    },
    {
      "id": "AR-30",
      "summary": "Ensure the backend recognizes the Internet Identity principal `ih4li-2xvzb-eiqhx-p746g-mfu4p-qceq3-iq7li-gh4d2-3ajo4-qldaw-iqe` as an admin in the backend access-control allowlist so `isCallerAdmin()` returns `true` for that principal after sign-in.",
      "reqIds": [
        "REQ-52"
      ],
      "status": "pending"
    },
    {
      "id": "AR-31",
      "summary": "Fix/ensure Send BTC transactions are actually broadcast and posted on the Bitcoin mainnet (on-chain), and reflect correct status in the app when a user sends credits to a wallet.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-32",
      "summary": "Update the backend `sendBTC(destination, amount)` flow so that creating a Bitcoin mainnet transfer also triggers an on-chain broadcast attempt (via the app’s configured blockchain API/outcall path), and records the resulting on-chain transaction ID (txid) when broadcast succeeds.",
      "reqIds": [
        "REQ-56"
      ],
      "status": "pending"
    },
    {
      "id": "AR-33",
      "summary": "Ensure funds/ledger accounting stays correct when an on-chain broadcast fails: if the backend cannot broadcast a transaction for a new Send BTC request, the request must be marked `FAILED` and the user’s credits must be restored so the user is not charged for an unposted on-chain transfer.",
      "reqIds": [
        "REQ-57"
      ],
      "status": "pending"
    },
    {
      "id": "AR-34",
      "summary": "Enable real on-chain broadcast for the backend `sendBTC(destination, amount)` flow so that a Send BTC action attempts to post a Bitcoin mainnet transaction instead of always returning `BTC_API_DISABLED`. Use the existing http-outcalls capability (`http-outcalls/outcall`) to perform the broadcast via the app’s configured blockchain API/outcall path, and capture the resulting on-chain transaction ID (txid) when available.",
      "reqIds": [
        "REQ-60"
      ],
      "status": "pending"
    },
    {
      "id": "AR-35",
      "summary": "Fix backend failure semantics so users are not charged for unposted on-chain transfers and the app can still show an auditable transfer record. Specifically: if broadcast fails, do not delete the transfer request; mark it as `FAILED`, keep `blockchainTxId = null`, restore the user balance for the full `totalCost`, and ensure transaction history does not incorrectly show a net debit for a failed broadcast.",
      "reqIds": [
        "REQ-61"
      ],
      "status": "pending"
    },
    {
      "id": "AR-36",
      "summary": "Align backend transfer status updates with the UI’s on-chain lifecycle: after a successful broadcast, persist the request with `blockchainTxId` set and a non-failed status that indicates “broadcast submitted / in progress” (do not mark as `FAILED`). The status must support the existing frontend status labels (`IN_PROGRESS`, `FAILED`, etc.) shown in the transfer details dialog.",
      "reqIds": [
        "REQ-62"
      ],
      "status": "pending"
    },
    {
      "id": "AR-37",
      "summary": "Add an in-app “cloud mining” capability (AI solving complex puzzles) that converts the resulting output into admin credits.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-38",
      "summary": "Update the backend `sendBTC(destination, amount)` flow so that creating a Send BTC request results in a real Bitcoin mainnet transaction broadcast attempt to the receiver address (instead of always returning `BTC_API_DISABLED`), and persist the resulting on-chain transaction ID (txid) on success.",
      "reqIds": [
        "REQ-64"
      ],
      "status": "pending"
    },
    {
      "id": "AR-39",
      "summary": "Fix backend failure/rollback semantics for Send BTC so users are not charged when an on-chain broadcast fails or is unavailable, while still keeping an auditable transfer record in the app.",
      "reqIds": [
        "REQ-65"
      ],
      "status": "pending"
    },
    {
      "id": "AR-40",
      "summary": "Align backend transfer status updates with the frontend’s on-chain lifecycle display: after a successful broadcast, persist the request with a status that represents “broadcast submitted / in progress” and include `blockchainTxId` when available; do not mark broadcast-success transfers as `FAILED`.",
      "reqIds": [
        "REQ-66"
      ],
      "status": "pending"
    },
    {
      "id": "AR-41",
      "summary": "Make each user profile act as an app-managed (custodial) anonymous Bitcoin wallet so users can send BTC to mainnet addresses with credits and have transactions broadcast via blockchain network APIs.",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-42",
      "summary": "Extend the backend user profile model so each authenticated user has a persistent, app-managed anonymous Bitcoin wallet identity that is created on first use and can be fetched later.",
      "reqIds": [
        "REQ-68"
      ],
      "status": "pending"
    },
    {
      "id": "AR-43",
      "summary": "Add backend APIs to retrieve the caller’s wallet identity (e.g., deposit address / wallet address) and ensure it is created if missing.",
      "reqIds": [
        "REQ-69"
      ],
      "status": "pending"
    },
    {
      "id": "AR-44",
      "summary": "Add a user-facing capability to confirm/verify that a Send BTC transfer request has completed on Bitcoin mainnet (e.g., show on-chain confirmation/completion state for the transfer).",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-45",
      "summary": "Update the backend `sendBTC(destination, amount)` flow so that creating a transfer request attempts an on-chain Bitcoin mainnet broadcast (instead of always returning `BTC_API_DISABLED`), and persists the resulting on-chain transaction id (txid) on the `SendBTCRequest.blockchainTxId` when broadcast succeeds.",
      "reqIds": [
        "REQ-73"
      ],
      "status": "pending"
    },
    {
      "id": "AR-46",
      "summary": "Fix backend failure/rollback semantics for Send BTC so users are not charged for an unposted on-chain transfer while preserving an auditable transfer record: when broadcast fails or is unavailable, do not delete the transfer request; mark it `FAILED`, restore the user’s credits for the full `totalCost`, and ensure transaction history reflects that the funds were restored.",
      "reqIds": [
        "REQ-74"
      ],
      "status": "pending"
    },
    {
      "id": "AR-47",
      "summary": "Add a backend capability to confirm a transfer’s completion on Bitcoin mainnet and update the saved `SendBTCRequest.status` accordingly, so the app can show a reliable completion state (e.g., move from `IN_PROGRESS` to `COMPLETED` once confirmed).",
      "reqIds": [
        "REQ-75"
      ],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "Bitcoin Credit Transfer",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}