{
  "kind": "build_request",
  "title": "Fix mainnet BTC send function backend support",
  "projectName": "Bitcoin Credit Transfer",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-1",
      "text": "Diagnose why the sendBtc function fails when attempting to broadcast Bitcoin transactions to mainnet. Examine the backend main.mo implementation for HTTP outcall errors, API endpoint issues, or network configuration problems preventing mainnet transaction broadcasting.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "Send btc function to mainnet not supported on backend"
        ]
      },
      "acceptanceCriteria": [
        "Root cause of sendBtc mainnet failure is identified",
        "Error logs or rejection messages clearly indicate the issue",
        "Diagnostic information is sufficient to implement a fix"
      ]
    },
    {
      "id": "REQ-2",
      "text": "Fix the backend sendBtc implementation to successfully broadcast signed Bitcoin transactions to mainnet using Internet Computer HTTP outcalls. Ensure the function can reach public blockchain APIs (e.g., Blockstream, Mempool.space) and handle responses correctly.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "Troubleshoot with ai"
        ]
      },
      "acceptanceCriteria": [
        "sendBtc function successfully broadcasts transactions to Bitcoin mainnet",
        "HTTP outcalls to blockchain APIs complete without rejection",
        "Transaction IDs are returned and can be verified on blockchain explorers",
        "Error handling properly distinguishes between network issues, API failures, and invalid transactions"
      ]
    },
    {
      "id": "REQ-3",
      "text": "Update the frontend SendBtcPage error handling to provide clear feedback when mainnet broadcasting fails, using the improved error messages from the fixed backend implementation.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ]
      },
      "acceptanceCriteria": [
        "Users see specific error messages when broadcasting fails",
        "Error messages distinguish between signing issues and broadcasting issues",
        "Troubleshooting guidance is accessible from error states"
      ]
    }
  ],
  "constraints": [
    "Maintain single-actor architecture in backend/main.mo",
    "Preserve existing transaction data structures and state",
    "Do not modify Internet Identity authentication flow",
    "Keep HTTP outcall implementation compatible with Internet Computer constraints",
    "Do not edit immutable frontend paths: useInternetIdentity.ts, useActor.ts, main.tsx, components/ui/*"
  ],
  "nonGoals": [
    "Implementing localhost Bitcoin Core node connectivity",
    "Adding WebSocket support for real-time transaction updates",
    "Implementing multisig wallet functionality",
    "Integrating third-party payment APIs beyond existing Stripe support",
    "Adding mobile-specific features or React Native support"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}