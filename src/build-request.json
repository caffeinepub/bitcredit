{
  "kind": "build_request",
  "title": "Remove user registration check blocking admin transfers",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-190",
      "text": "Remove any backend code that checks whether the destination address is a registered user account before allowing a Send BTC transfer to proceed, so that admins (and regular users) can complete transfers to any valid Bitcoin mainnet address without encountering a 'user not registered' error.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "user not registered when attempting to transfer"
        ]
      },
      "acceptanceCriteria": [
        "The backend sendBTC flow accepts any destination address text without checking if it corresponds to a registered user profile",
        "The 'user not registered' error no longer appears when an admin attempts a Send BTC transfer",
        "Transfers can be completed to any Bitcoin mainnet address regardless of whether the recipient has an account in the app"
      ]
    },
    {
      "id": "REQ-191",
      "text": "Ensure the signed-in admin principal (ih4li-2xvzb-eiqhx-p746g-mfu4p-qceq3-iq7li-gh4d2-3ajo4-qldaw-iqe) is recognized by the backend admin access control and can successfully complete Send BTC transfers without being blocked by any user registration or account status checks.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-last"
        ],
        "quotes": [
          "recognize my UI as admin to complete transaction"
        ]
      },
      "acceptanceCriteria": [
        "The backend isCallerAdmin() method returns true for the specified admin principal",
        "The admin can access all admin-protected routes and operations without errors",
        "The admin can successfully create and broadcast Send BTC transfers from the Admin Send BTC to Mainnet Wallet section"
      ]
    },
    {
      "id": "REQ-192",
      "text": "Add development-only logging to the backend sendBTC flow that captures and surfaces (a) the destination address being processed, (b) any validation checks performed on the destination, (c) any checks for user account existence or registration status, and (d) the specific error/trap message when a transfer fails, so it is easier to identify where incorrect account-registration requirements are being enforced.",
      "target": "backend",
      "source": {
        "messageIds": [
          "msg-last"
        ]
      },
      "acceptanceCriteria": [
        "Development logs show the destination address and validation steps for each sendBTC call",
        "Any account existence checks are clearly logged with their outcome",
        "Error messages include enough detail to identify the source of 'user not registered' errors"
      ]
    }
  ],
  "constraints": [
    "Maintain single-actor architecture; all Motoko logic remains in backend/main.mo",
    "Do not modify immutable frontend paths: frontend/src/hooks/useInternetIdentity.ts, frontend/src/hooks/useInternetIdentity.tsx, frontend/src/hooks/useActor.ts, frontend/src/main.tsx, frontend/src/components/ui",
    "Preserve existing admin access control initialization via caffeineAdminToken URL parameter",
    "Do not break existing transfer history, ledger accounting, or reserve tracking"
  ],
  "nonGoals": [
    "Adding new address validation libraries or formats beyond what blockchain APIs already support",
    "Implementing new user registration flows",
    "Changing the admin allowlist management UI",
    "Modifying the frontend Send BTC form (address format validation already removed)"
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}