{
  "kind": "build_request",
  "title": "Add USD estimates to transaction history and create AI-driven Lottery page",
  "projectName": "BTC Credits",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-146",
      "text": "Display an estimated USD value for each transaction amount in the Transaction History UI, using the existing live BTC/USD price query and the same clear English estimate disclosure already used in balance cards.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-4"
        ],
        "quotes": [
          "Yes add to transaction history"
        ]
      },
      "acceptanceCriteria": [
        "On `/history`, each transaction row (in `frontend/src/components/transfers/TransferHistoryTable.tsx`) shows the BTC-denominated amount and, directly beneath it, an estimated USD value line when BTC/USD price data is available.",
        "When BTC/USD price data is unavailable or still loading, the UI shows an English placeholder consistent with `frontend/src/components/balance/UsdEstimateLine.tsx` behavior (e.g., loading skeleton and/or “USD value unavailable”).",
        "The USD estimate copy includes the existing English disclosure that it is an estimate and can fluctuate (same wording as `UsdEstimateLine`).",
        "The implementation uses the existing `useGetCurrentBtcPriceUsd()` hook from `frontend/src/hooks/useQueries.ts` (no new price-fetching mechanism).",
        "User-facing text added/changed for this requirement is in clear English."
      ]
    },
    {
      "id": "REQ-147",
      "text": "Add a new authenticated “AI Lottery” page that generates Powerball-style number outcomes based on the user-provided algorithm concept (recent draw data + filtered selection), and make it reachable via routing and navigation.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-4"
        ],
        "quotes": [
          "Add ai driven lottery page with this code",
          "url = \"https://data.ny.gov\"",
          "def ai_spin_filtered_by_errors():"
        ]
      },
      "acceptanceCriteria": [
        "A new route is added in `frontend/src/App.tsx` for the Lottery page (for example: `/ai-lottery`) and it is accessible to signed-in users under the existing `AuthGate` flow.",
        "The main app navigation is updated to include a link to the Lottery page (update `frontend/src/components/layout/AppHeader.tsx` nav links list).",
        "A new page component is created (e.g., `frontend/src/pages/AiLotteryPage.tsx`) that renders: (1) a page title, (2) a short English explanation of what the page does, (3) a primary action to generate outcomes (e.g., “Generate AI Spins”), and (4) a results area that displays 3 outcomes with: Spin number, 5 sorted main numbers (1–69), Powerball (1–26), and an “AI Confidence” percentage (70%–95%).",
        "The page attempts to fetch recent draw data from the user-provided URL `https://data.ny.gov` and uses the fetched data when possible; if the fetch fails or the data is not usable as expected, the UI must show a clear English error state and still allow the user to generate outcomes using a local fallback dataset/logic so the page remains usable.",
        "The UI includes an explicit English disclosure that lottery outcomes are for entertainment only, do not improve odds, and do not guarantee winnings.",
        "The UI includes an explicit English disclosure that the app is not running Python/scikit-learn code in the browser or backend, and that the displayed results are generated in-app using a simplified, Powerball-style randomization approach inspired by the provided pseudocode.",
        "All user-facing text added for this page is in clear English."
      ]
    }
  ],
  "constraints": [
    "Do not modify any files under `frontend/src/components/ui` (Shadcn UI components are read-only in this project).",
    "Do not edit files listed in `frontend.immutablePaths` in SYSTEM_CONTEXT (compose them instead).",
    "Do not introduce Python, scikit-learn, LangChain, or any external AI/LLM integrations; implement the Lottery logic in the existing React + TypeScript frontend stack only.",
    "Keep all user-facing text in clear English."
  ],
  "nonGoals": [
    "Do not add any backend canister endpoints specifically for the Lottery page (no new Motoko APIs required for this request).",
    "Do not store Lottery results in the credit ledger or transaction history (only display on the Lottery page).",
    "Do not integrate any real-money lottery purchasing, ticket submission, or payment flows."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  },
  "userProfileUpdate": {
    "goalsToAdd": [],
    "goalsToRemove": [],
    "preferencesToAdd": [],
    "preferencesToRemove": [],
    "miscToAdd": [],
    "miscToRemove": [],
    "fieldsToSet": {},
    "fieldsToDelete": []
  }
}